# MQTT Integration

## Add an MQTT Integration

To add an integration, go to **Integrations** on the left menu. Select the integration to add - in this case, the **MQTT** integration.

The next step is to paste your MQTT broker endpoint, and optional topic prefix.

### MQTT Topic composition:

**Device Uplink (Receive Data from Device)**  
Subscribe to:  
{optional_prefix}/helium/{AppEui MSB HEX Short Form}/rx  

Example with prefix: `mqtt/helium/0000000100000009/rx`  
Example without prefix: `helium/0000000100000009/rx` 

**Device Downlink (Send Data to Device)**  
Publish to:  
{optional_prefix}/helium/{AppEui MSB HEX Short Form}/tx  

Example with prefix: `mqtt/helium/0000000100000009/tx`  
Example without prefix: `helium/0000000100000009/tx` 

**Sending Data to Device:**  
Use payload_raw field and send a base64 encoded array of bytes.  
JSON Example:
```
{
   "payload_raw": "encoded_string"
}
```

## Send and Receive Device Data

The following examples are done with the [MQTT CLI](https://hivemq.github.io/mqtt-cli) utility.

Example MQTT 

**Subscribe to Uplink Packets:**
```
mqtt sub -V 3 -t helium/0000000100000009/rx -h {mqtt_broker_host} -p {mqtt_broker_host_port} -u "user" -pw "password"
```

**Publish Downlink Packet:**
```
mqtt pub -V 3 -t helium/0000000100000009/tx -h {mqtt_broker_host} -p {mqtt_broker_host_port} -u "user" -pw "password" -m "{\"payload_raw\":\"encoded_string\"}"
```